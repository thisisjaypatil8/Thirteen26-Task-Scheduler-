{
    "sourceFile": "src/services/geminiService.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1762693898014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762693904740,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n // This is the correct, stable endpoint.\r\n const GEMINI_API_URL_BASE = \"https://generativela_nguage.googleapis.com/v1/models/gemini-2.5-pro:generateContent?key=\";\r\n \r\n const FIXED_EVENTS = `\r\n-    - Sleep (12am - 8am)\r\n+    - Sleep (1m - 8am)\r\n     - Breakfast (8:30am - 9am)\r\n     - Lunch (1pm - 1:30pm)\r\n     - Dinner (7pm - 8pm)\r\n     - Shower (8am - 8:30am)\r\n"
                },
                {
                    "date": 1762693910926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n // This is the correct, stable endpoint.\r\n const GEMINI_API_URL_BASE = \"https://generativela_nguage.googleapis.com/v1/models/gemini-2.5-pro:generateContent?key=\";\r\n \r\n const FIXED_EVENTS = `\r\n-    - Sleep (1m - 8am)\r\n+    - Sleep (10pm - am)\r\n     - Breakfast (8:30am - 9am)\r\n     - Lunch (1pm - 1:30pm)\r\n     - Dinner (7pm - 8pm)\r\n     - Shower (8am - 8:30am)\r\n"
                },
                {
                    "date": 1762693922588,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n const FIXED_EVENTS = `\r\n     - Sleep (10pm - 6am)\r\n     - Breakfast (8:30am - 9am)\r\n     - Lunch (1pm - 1:30pm)\r\n-    - Dinner (7pm - 8pm)\r\n+    - Dinner (pm - 8pm)\r\n     - Shower (8am - 8:30am)\r\n `;\r\n \r\n // It now accepts currentTime\r\n"
                },
                {
                    "date": 1762696028322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,89 @@\n+// This is the correct, stable endpoint.\r\n+const GEMINI_API_URL_BASE = \"https://generativela_nguage.googleapis.com/v1/models/gemini-2.5-pro:generateContent?key=\";\r\n+\r\n+const FIXED_EVENTS = `\r\n+    - Sleep (10pm - 6am)\r\n+    - Breakfast (8:30am - 9am)\r\n+    - Lunch (1pm - 1:30pm)\r\n+    - Dinner (8pm - 9pm)\r\n+    - Shower (8am - 8:30am)\r\n+`;\r\n+\r\n+// It now accepts currentTime\r\n+export const getAISchedule = async (taskInput, apiKey, currentTime) => {\r\n+    \r\n+    // Format the current time for the prompt\r\n+    const hh = String(currentTime.getHours()).padStart(2, '0');\r\n+    const mm = String(currentTime.getMinutes()).padStart(2, '0');\r\n+    const timeString = `${hh}:${mm}`;\r\n+\r\n+    const prompt = `\r\n+        You are an expert executive assistant. Your job is to create a 24-hour schedule.\r\n+\r\n+        CONTEXT:\r\n+        - Today is ${new Date().toLocaleDateString()}.\r\n+        - The CURRENT TIME is ${timeString}. You MUST NOT schedule any tasks or events before this time.\r\n+        - The user's 'fixed' events are: ${FIXED_EVENTS}\r\n+        - The user's sleep time is approximately 12am (00:00). Do not schedule tasks past this time.\r\n+\r\n+        USER TASK LIST:\r\n+        ${taskInput}\r\n+\r\n+        YOUR TASK:\r\n+        1.  Analyze the user's task list.\r\n+        2.  Schedule all tasks ONLY for the remaining time of the day (between ${timeString} and 00:00).\r\n+        3.  Intelligently assign 'startTime', 'endTime', and 'priority' for tasks without them.\r\n+        4.  If a task from the list CANNOT be scheduled today, list it in a 'couldNotSchedule' array.\r\n+        5.  If all tasks are scheduled and there is time left, you MUST label these blocks 'Free Time'.\r\n+        6.  Do NOT add generic 'Focus Work' or 'Admin Tasks' unless the user explicitly requested them.\r\n+        7.  You MUST reply with ONLY a valid JSON object. Do not write any other text.\r\n+\r\n+        OUTPUT FORMAT (JSON Object only):\r\n+        {\r\n+            \"schedule\": [\r\n+                { \"task\": \"Task Name\", \"startTime\": \"HH:MM\", \"endTime\": \"HH:MM\", \"priority\": \"high\" },\r\n+                { \"task\": \"Free Time\", \"startTime\": \"HH:MM\", \"endTime\": \"HH:MM\", \"priority\": \"low\" }\r\n+            ],\r\n+            \"couldNotSchedule\": [\r\n+                \"Task that didn't fit\"\r\n+            ]\r\n+        }\r\n+    `;\r\n+\r\n+    const response = await fetch(GEMINI_API_URL_BASE + apiKey, {\r\n+        method: 'POST',\r\n+        headers: {\r\n+            'Content-Type': 'application/json',\r\n+        },\r\n+        body: JSON.stringify({\r\n+            contents: [{ parts: [{ text: prompt }] }]\r\n+        })\r\n+    });\r\n+\r\n+    if (!response.ok) {\r\n+        const errorData = await response.json();\r\n+        throw new Error(`API Error: ${response.status} ${response.statusText} - ${errorData.error.message}`);\r\n+    }\r\n+\r\n+    const data = await response.json();\r\n+    \r\n+    let jsonString = data.candidates[0].content.parts[0].text;\r\n+    jsonString = jsonString.replace(/```json/g, \"\").replace(/```/g, \"\").trim();\r\n+\r\n+    // Parse the new object structure\r\n+    const responseObject = JSON.parse(jsonString);\r\n+\r\n+    const schedule = responseObject.schedule || [];\r\n+    const couldNotSchedule = responseObject.couldNotSchedule || [];\r\n+\r\n+    // Sort schedule by start time and add a unique ID\r\n+    schedule.sort((a, b) => a.startTime.localeCompare(b.startTime));\r\n+    \r\n+    const finalSchedule = schedule.map((item, index) => ({\r\n+        ...item,\r\n+        id: `${item.startTime}-${item.task}-${index}` // Create a stable unique ID\r\n+    }));\r\n+\r\n+    // Return an object with both arrays\r\n+    return { finalSchedule, couldNotSchedule };\r\n+};\n\\ No newline at end of file\n"
                }
            ],
            "date": 1762693898014,
            "name": "Commit-0",
            "content": "// This is the correct, stable endpoint.\r\nconst GEMINI_API_URL_BASE = \"https://generativela_nguage.googleapis.com/v1/models/gemini-2.5-pro:generateContent?key=\";\r\n\r\nconst FIXED_EVENTS = `\r\n    - Sleep (12am - 8am)\r\n    - Breakfast (8:30am - 9am)\r\n    - Lunch (1pm - 1:30pm)\r\n    - Dinner (7pm - 8pm)\r\n    - Shower (8am - 8:30am)\r\n`;\r\n\r\n// It now accepts currentTime\r\nexport const getAISchedule = async (taskInput, apiKey, currentTime) => {\r\n    \r\n    // Format the current time for the prompt\r\n    const hh = String(currentTime.getHours()).padStart(2, '0');\r\n    const mm = String(currentTime.getMinutes()).padStart(2, '0');\r\n    const timeString = `${hh}:${mm}`;\r\n\r\n    const prompt = `\r\n        You are an expert executive assistant. Your job is to create a 24-hour schedule.\r\n\r\n        CONTEXT:\r\n        - Today is ${new Date().toLocaleDateString()}.\r\n        - The CURRENT TIME is ${timeString}. You MUST NOT schedule any tasks or events before this time.\r\n        - The user's 'fixed' events are: ${FIXED_EVENTS}\r\n        - The user's sleep time is approximately 12am (00:00). Do not schedule tasks past this time.\r\n\r\n        USER TASK LIST:\r\n        ${taskInput}\r\n\r\n        YOUR TASK:\r\n        1.  Analyze the user's task list.\r\n        2.  Schedule all tasks ONLY for the remaining time of the day (between ${timeString} and 00:00).\r\n        3.  Intelligently assign 'startTime', 'endTime', and 'priority' for tasks without them.\r\n        4.  If a task from the list CANNOT be scheduled today, list it in a 'couldNotSchedule' array.\r\n        5.  If all tasks are scheduled and there is time left, you MUST label these blocks 'Free Time'.\r\n        6.  Do NOT add generic 'Focus Work' or 'Admin Tasks' unless the user explicitly requested them.\r\n        7.  You MUST reply with ONLY a valid JSON object. Do not write any other text.\r\n\r\n        OUTPUT FORMAT (JSON Object only):\r\n        {\r\n            \"schedule\": [\r\n                { \"task\": \"Task Name\", \"startTime\": \"HH:MM\", \"endTime\": \"HH:MM\", \"priority\": \"high\" },\r\n                { \"task\": \"Free Time\", \"startTime\": \"HH:MM\", \"endTime\": \"HH:MM\", \"priority\": \"low\" }\r\n            ],\r\n            \"couldNotSchedule\": [\r\n                \"Task that didn't fit\"\r\n            ]\r\n        }\r\n    `;\r\n\r\n    const response = await fetch(GEMINI_API_URL_BASE + apiKey, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            contents: [{ parts: [{ text: prompt }] }]\r\n        })\r\n    });\r\n\r\n    if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(`API Error: ${response.status} ${response.statusText} - ${errorData.error.message}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    let jsonString = data.candidates[0].content.parts[0].text;\r\n    jsonString = jsonString.replace(/```json/g, \"\").replace(/```/g, \"\").trim();\r\n\r\n    // Parse the new object structure\r\n    const responseObject = JSON.parse(jsonString);\r\n\r\n    const schedule = responseObject.schedule || [];\r\n    const couldNotSchedule = responseObject.couldNotSchedule || [];\r\n\r\n    // Sort schedule by start time and add a unique ID\r\n    schedule.sort((a, b) => a.startTime.localeCompare(b.startTime));\r\n    \r\n    const finalSchedule = schedule.map((item, index) => ({\r\n        ...item,\r\n        id: `${item.startTime}-${item.task}-${index}` // Create a stable unique ID\r\n    }));\r\n\r\n    // Return an object with both arrays\r\n    return { finalSchedule, couldNotSchedule };\r\n};"
        }
    ]
}